"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/socketio";
exports.ids = ["pages/api/socketio"];
exports.modules = {

/***/ "socket.io":
/*!****************************!*\
  !*** external "socket.io" ***!
  \****************************/
/***/ ((module) => {

module.exports = import("socket.io");;

/***/ }),

/***/ "uuid":
/*!***********************!*\
  !*** external "uuid" ***!
  \***********************/
/***/ ((module) => {

module.exports = import("uuid");;

/***/ }),

/***/ "(api)/./pages/api/socketio.js":
/*!*******************************!*\
  !*** ./pages/api/socketio.js ***!
  \*******************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"config\": () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var socket_io__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! socket.io */ \"socket.io\");\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! uuid */ \"uuid\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([socket_io__WEBPACK_IMPORTED_MODULE_0__, uuid__WEBPACK_IMPORTED_MODULE_1__]);\n([socket_io__WEBPACK_IMPORTED_MODULE_0__, uuid__WEBPACK_IMPORTED_MODULE_1__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\nconst Socketio = (req, res)=>{\n    // let ROOMS = [];\n    const WIN_CON = [\n        [\n            0,\n            1,\n            2\n        ],\n        [\n            3,\n            4,\n            5\n        ],\n        [\n            6,\n            7,\n            8\n        ],\n        [\n            0,\n            3,\n            6\n        ],\n        [\n            1,\n            4,\n            7\n        ],\n        [\n            2,\n            5,\n            8\n        ],\n        [\n            0,\n            4,\n            8\n        ],\n        [\n            2,\n            4,\n            6\n        ]\n    ];\n    let ROOMS = [];\n    let PLAYERS = [];\n    res.status(200).json({\n        user: \"hazel\"\n    });\n    if (!res.socket.server.io) {\n        console.log(\"*First use, starting socket.io\");\n        const io = new socket_io__WEBPACK_IMPORTED_MODULE_0__.Server(res.socket.server);\n        // SOCKET IOs\n        const getUniqueListBy = (arr, key)=>{\n            return [\n                ...new Map(arr.map((item)=>[\n                        item[key],\n                        item\n                    ])).values()\n            ];\n        };\n        const isPlayerExist = (obj)=>{\n            for(let i = 0; i < PLAYERS.length; i++){\n                if (PLAYERS[i].id === obj.id && PLAYERS[i].name === obj.name) {\n                    return true;\n                }\n            }\n            return false;\n        };\n        io.on(\"connection\", (socket)=>{\n            const emitserverData = ()=>{\n                io.emit(\"server-data\", {\n                    onlinePlayers: PLAYERS.filter((p)=>{\n                        if (p.status === \"online\") {\n                            return true;\n                        }\n                        return false;\n                    }).length\n                });\n            };\n            socket.onAny((event, args)=>{\n                if (event === \"player-details\") {\n                    if (args.type === \"initial\") {\n                        const obj = {\n                            socketId: socket.id,\n                            id: args.id,\n                            name: args.name,\n                            win: 0,\n                            lose: 0,\n                            draw: 0,\n                            status: \"online\"\n                        };\n                        if (!isPlayerExist(obj)) {\n                            PLAYERS.push(obj);\n                        } else {\n                            const objIndex = PLAYERS.findIndex((obj)=>obj.id === args.id);\n                            PLAYERS[objIndex].status = \"online\";\n                            PLAYERS[objIndex].socketId = socket.id;\n                        }\n                    }\n                }\n                emitserverData();\n            });\n            // socket.on('player-details', (data) => {\n            //     console.log(data);\n            // })\n            socket.on(\"enemy-timer\", (data)=>{\n                socket.to(data.room).emit(\"enemy-timer\", {\n                    timer: data.timer\n                });\n            });\n            socket.on(\"disconnecting\", ()=>{\n                const room = Array.from(socket.rooms)[1];\n                socket.leave(room);\n                // socket.to(room).emit('enemy-disconnect', {});\n                socket.to(room).emit(\"exit-room\", {});\n                // set the player to offline\n                const objIndex = PLAYERS.findIndex((obj)=>obj.socketId === socket.id);\n                if (objIndex >= 0) {\n                    PLAYERS[objIndex].status = \"offline\";\n                    PLAYERS[objIndex].socketId = \"\";\n                }\n                // remove room/s that belongs to someone disconnected\n                ROOMS = ROOMS.filter((item)=>item.hostId !== socket.id);\n                emitserverData();\n            });\n            socket.on(\"exit-room\", (data, callback)=>{\n                socket.leave(data.room);\n                ROOMS = ROOMS.filter((item)=>item.room !== data.room);\n                callback({\n                    status: \"ok\"\n                });\n                socket.to(data.room).emit(\"exit-room\", {});\n            });\n            socket.on(\"rematch\", (data, callback)=>{\n                socket.to(data.room).emit(\"rematch\");\n                if (typeof data.acceptRematch !== \"undefined\") {\n                    if (data.acceptRematch) {\n                        console.log(\"accepted\");\n                        io.to(data.room).emit(\"game-ready\", {\n                            isReady: true\n                        });\n                    }\n                }\n                callback({\n                    status: \"ok\"\n                });\n            });\n            socket.on(\"move\", (data)=>{\n                socket.to(data.room).emit(\"move\", {\n                    moves: data.moves,\n                    turn: data.turn\n                });\n                const winObj = checkWinV2(data.turn, data.moves);\n                if (winObj !== false) {\n                    io.to(data.room).emit(\"game-result\", {\n                        winner: winObj.symbol,\n                        result: \"done\",\n                        combination: winObj.combination\n                    });\n                } else if (isDraw(data.moves)) {\n                    console.log(\"draw\", isDraw(data.moves));\n                    io.to(data.room).emit(\"game-result\", {\n                        winner: \"none\",\n                        result: \"draw\"\n                    });\n                }\n            });\n            socket.on(\"times-up\", (data)=>{\n                io.to(data.room).emit(\"game-result\", {\n                    winner: \"none\",\n                    result: \"timesup\",\n                    winner: data.symbol === \"x\" ? \"circle\" : \"x\"\n                });\n            });\n            socket.on(\"join-room\", (data)=>{\n                getAvailableRoom(io).then((r)=>{\n                    if (r) {\n                        // find available room and join\n                        getRoomDetails(r).then((h)=>{\n                            if (h) {\n                                socket.emit(\"joined-room\", {\n                                    room: r,\n                                    isHost: false,\n                                    isReady: true,\n                                    name: typeof h.hostName === \"undefined\" || h.hostName === null || h.hostName === \"\" ? \"unknown\" : h.hostName\n                                });\n                                socket.to(r).emit(\"game-ready\", {\n                                    isReady: true,\n                                    name: data.name\n                                });\n                                socket.join(r);\n                            }\n                        });\n                    } else {\n                        // create room\n                        let autoroom = (0,uuid__WEBPACK_IMPORTED_MODULE_1__.v4)();\n                        socket.join(autoroom);\n                        ROOMS.push({\n                            hostId: data.id,\n                            hostName: data.name,\n                            room: autoroom\n                        });\n                        socket.emit(\"joined-room\", {\n                            room: autoroom,\n                            isHost: true,\n                            isReady: false\n                        });\n                    }\n                });\n            });\n        });\n        function getActiveRooms(io) {\n            // Convert map into 2D list:\n            // ==> [['4ziBKG9XFS06NdtVAAAH', Set(1)], ['room1', Set(2)], ...]\n            const arr = Array.from(io.sockets.adapter.rooms);\n            // Filter rooms whose name exist in set:\n            // ==> [['room1', Set(2)], ['room2', Set(2)]]\n            const filtered = arr.filter((room)=>!room[1].has(room[0]));\n            // Return only the room name: \n            // ==> ['room1', 'room2']\n            const res = filtered.map((i)=>i[0]);\n            return res;\n        }\n        const adminGetRooms = (io)=>{\n            io.emit(\"admin-rooms\", {\n                rooms: ROOMS,\n                activeRooms: getActiveRooms(io)\n            });\n        };\n        const isDraw = (_moves)=>{\n            return [\n                ..._moves\n            ].every((index)=>{\n                return index === \"circle\" || index === \"x\";\n            });\n        };\n        const checkWin = (symbol, _moves)=>{\n            return WIN_CON.some((combination)=>{\n                return combination.every((index)=>{\n                    return _moves[index] === symbol;\n                });\n            });\n        };\n        const checkWinV2 = (symbol, _moves)=>{\n            for(let i = 0; i < WIN_CON.length; i++){\n                const c = WIN_CON[i].every((index)=>_moves[index] === symbol);\n                if (c) return {\n                    combination: WIN_CON[i],\n                    symbol: symbol\n                };\n            }\n            return false;\n        };\n        const getAvailableRoom = async (io)=>{\n            const rooms = getActiveRooms(io);\n            for (let room of rooms){\n                let c = await io.in(room).fetchSockets();\n                let filtered = c.map(function(item) {\n                    return item.id;\n                });\n                if (filtered.length === 1) {\n                    return room;\n                } else {\n                    console.log(\"no room available\");\n                }\n            }\n        };\n        const getRoomDetails = async (room)=>{\n            const h = await ROOMS.find((item)=>item.room === room);\n            if (h) {\n                return h;\n            } else {\n                console.log(\"Error: No room found, Function: getRoomDetails\");\n            }\n        };\n        const getRoomClients = async (io, room)=>{\n            const c = await io.in(room).fetchSockets();\n            const filtered = c.map(function(item) {\n                return item.id;\n            });\n            return filtered;\n        };\n        res.socket.server.io = io;\n    } else {\n    // console.log('socket.io already running');\n    }\n    res.end();\n};\nconst config = {\n    api: {\n        bodyParser: false\n    }\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Socketio);\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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R1MsQ0FBQyxDQUFDcEUsR0FBRyxDQUFDLFNBQVVDLElBQUksRUFBRTtnQkFBRSxPQUFPQSxJQUFJLENBQUNNLEVBQUUsQ0FBQztZQUFDLENBQUMsQ0FBQztZQUMzRCxPQUFPb0QsUUFBUSxDQUFDO1FBQ3BCLENBQUM7UUFFRDNFLEdBQUcsQ0FBQ08sTUFBTSxDQUFDQyxNQUFNLENBQUNDLEVBQUUsR0FBR0EsRUFBRTtJQUM3QixPQUFPO0lBQ0gsNENBQTRDO0lBQ2hELENBQUM7SUFDRFQsR0FBRyxDQUFDeUYsR0FBRyxFQUFFLENBQUM7QUFDZCxDQUFDO0FBRU0sTUFBTUMsTUFBTSxHQUFHO0lBQ2xCQyxHQUFHLEVBQUU7UUFDREMsVUFBVSxFQUFFLEtBQUs7S0FDcEI7Q0FDSjtBQUVELGlFQUFlOUYsUUFBUSxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vb25saW5lLXRpY3RhY3RvZS8uL3BhZ2VzL2FwaS9zb2NrZXRpby5qcz9lZDU1Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFNlcnZlciB9IGZyb20gJ3NvY2tldC5pbyc7XG5pbXBvcnQgeyB2NCBhcyB1dWlkdjQgfSBmcm9tICd1dWlkJztcblxuY29uc3QgU29ja2V0aW8gPSAocmVxLCByZXMpID0+IHtcbiAgICAvLyBsZXQgUk9PTVMgPSBbXTtcbiAgICBjb25zdCBXSU5fQ09OID0gW1xuICAgICAgICBbMCwgMSwgMl0sXG4gICAgICAgIFszLCA0LCA1XSxcbiAgICAgICAgWzYsIDcsIDhdLFxuICAgICAgICBbMCwgMywgNl0sXG4gICAgICAgIFsxLCA0LCA3XSxcbiAgICAgICAgWzIsIDUsIDhdLFxuICAgICAgICBbMCwgNCwgOF0sXG4gICAgICAgIFsyLCA0LCA2XVxuICAgIF07XG5cbiAgICBsZXQgUk9PTVMgPSBbXTtcbiAgICBsZXQgUExBWUVSUyA9IFtdO1xuXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyB1c2VyOiAnaGF6ZWwnIH0pO1xuXG4gICAgaWYgKCFyZXMuc29ja2V0LnNlcnZlci5pbykge1xuICAgICAgICBjb25zb2xlLmxvZygnKkZpcnN0IHVzZSwgc3RhcnRpbmcgc29ja2V0LmlvJylcblxuICAgICAgICBjb25zdCBpbyA9IG5ldyBTZXJ2ZXIocmVzLnNvY2tldC5zZXJ2ZXIpXG5cbiAgICAgICAgLy8gU09DS0VUIElPc1xuXG4gICAgICAgIGNvbnN0IGdldFVuaXF1ZUxpc3RCeSA9IChhcnIsIGtleSkgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIFsuLi5uZXcgTWFwKGFyci5tYXAoaXRlbSA9PiBbaXRlbVtrZXldLCBpdGVtXSkpLnZhbHVlcygpXVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgaXNQbGF5ZXJFeGlzdCA9IChvYmopID0+IHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgUExBWUVSUy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIGlmIChQTEFZRVJTW2ldLmlkID09PSBvYmouaWQgJiYgUExBWUVSU1tpXS5uYW1lID09PSBvYmoubmFtZSkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG5cbiAgICAgICAgaW8ub24oJ2Nvbm5lY3Rpb24nLCAoc29ja2V0KSA9PiB7XG5cbiAgICAgICAgICAgIGNvbnN0IGVtaXRzZXJ2ZXJEYXRhID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlvLmVtaXQoJ3NlcnZlci1kYXRhJywge1xuICAgICAgICAgICAgICAgICAgICBvbmxpbmVQbGF5ZXJzOiBQTEFZRVJTLmZpbHRlcihwID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwLnN0YXR1cyA9PT0gJ29ubGluZScpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIH0pLmxlbmd0aFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNvY2tldC5vbkFueSgoZXZlbnQsIGFyZ3MpID0+IHtcblxuICAgICAgICAgICAgICAgIGlmIChldmVudCA9PT0gJ3BsYXllci1kZXRhaWxzJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYXJncy50eXBlID09PSAnaW5pdGlhbCcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG9iaiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb2NrZXRJZDogc29ja2V0LmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiBhcmdzLmlkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGFyZ3MubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW46IDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9zZTogMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkcmF3OiAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogJ29ubGluZSdcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghaXNQbGF5ZXJFeGlzdChvYmopKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUExBWUVSUy5wdXNoKG9iaik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IG9iakluZGV4ID0gUExBWUVSUy5maW5kSW5kZXgob2JqID0+IG9iai5pZCA9PT0gYXJncy5pZCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUExBWUVSU1tvYmpJbmRleF0uc3RhdHVzID0gJ29ubGluZSc7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgUExBWUVSU1tvYmpJbmRleF0uc29ja2V0SWQgPSBzb2NrZXQuaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBlbWl0c2VydmVyRGF0YSgpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIHNvY2tldC5vbigncGxheWVyLWRldGFpbHMnLCAoZGF0YSkgPT4ge1xuICAgICAgICAgICAgLy8gICAgIGNvbnNvbGUubG9nKGRhdGEpO1xuICAgICAgICAgICAgLy8gfSlcblxuICAgICAgICAgICAgc29ja2V0Lm9uKCdlbmVteS10aW1lcicsIChkYXRhKSA9PiB7XG4gICAgICAgICAgICAgICAgc29ja2V0LnRvKGRhdGEucm9vbSkuZW1pdCgnZW5lbXktdGltZXInLCB7IHRpbWVyOiBkYXRhLnRpbWVyIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHNvY2tldC5vbignZGlzY29ubmVjdGluZycsICgpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCByb29tID0gQXJyYXkuZnJvbShzb2NrZXQucm9vbXMpWzFdO1xuICAgICAgICAgICAgICAgIHNvY2tldC5sZWF2ZShyb29tKTtcbiAgICAgICAgICAgICAgICAvLyBzb2NrZXQudG8ocm9vbSkuZW1pdCgnZW5lbXktZGlzY29ubmVjdCcsIHt9KTtcbiAgICAgICAgICAgICAgICBzb2NrZXQudG8ocm9vbSkuZW1pdCgnZXhpdC1yb29tJywge30pO1xuXG4gICAgICAgICAgICAgICAgLy8gc2V0IHRoZSBwbGF5ZXIgdG8gb2ZmbGluZVxuICAgICAgICAgICAgICAgIGNvbnN0IG9iakluZGV4ID0gUExBWUVSUy5maW5kSW5kZXgob2JqID0+IG9iai5zb2NrZXRJZCA9PT0gc29ja2V0LmlkKTtcbiAgICAgICAgICAgICAgICBpZiAob2JqSW5kZXggPj0gMCkge1xuICAgICAgICAgICAgICAgICAgICBQTEFZRVJTW29iakluZGV4XS5zdGF0dXMgPSAnb2ZmbGluZSc7XG4gICAgICAgICAgICAgICAgICAgIFBMQVlFUlNbb2JqSW5kZXhdLnNvY2tldElkID0gJyc7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gcmVtb3ZlIHJvb20vcyB0aGF0IGJlbG9uZ3MgdG8gc29tZW9uZSBkaXNjb25uZWN0ZWRcbiAgICAgICAgICAgICAgICBST09NUyA9IFJPT01TLmZpbHRlcihpdGVtID0+IGl0ZW0uaG9zdElkICE9PSBzb2NrZXQuaWQpO1xuICAgICAgICAgICAgICAgIGVtaXRzZXJ2ZXJEYXRhKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgc29ja2V0Lm9uKCdleGl0LXJvb20nLCAoZGF0YSwgY2FsbGJhY2spID0+IHtcbiAgICAgICAgICAgICAgICBzb2NrZXQubGVhdmUoZGF0YS5yb29tKTtcbiAgICAgICAgICAgICAgICBST09NUyA9IFJPT01TLmZpbHRlcihpdGVtID0+IGl0ZW0ucm9vbSAhPT0gZGF0YS5yb29tKTtcbiAgICAgICAgICAgICAgICBjYWxsYmFjayh7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogJ29rJ1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHNvY2tldC50byhkYXRhLnJvb20pLmVtaXQoJ2V4aXQtcm9vbScsIHt9KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBzb2NrZXQub24oJ3JlbWF0Y2gnLCAoZGF0YSwgY2FsbGJhY2spID0+IHtcbiAgICAgICAgICAgICAgICBzb2NrZXQudG8oZGF0YS5yb29tKS5lbWl0KCdyZW1hdGNoJyk7XG5cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGRhdGEuYWNjZXB0UmVtYXRjaCAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuYWNjZXB0UmVtYXRjaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2FjY2VwdGVkJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlvLnRvKGRhdGEucm9vbSkuZW1pdCgnZ2FtZS1yZWFkeScsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc1JlYWR5OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjYWxsYmFjayh7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogJ29rJ1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgc29ja2V0Lm9uKCdtb3ZlJywgKGRhdGEpID0+IHtcbiAgICAgICAgICAgICAgICBzb2NrZXQudG8oZGF0YS5yb29tKS5lbWl0KCdtb3ZlJywge1xuICAgICAgICAgICAgICAgICAgICBtb3ZlczogZGF0YS5tb3ZlcyxcbiAgICAgICAgICAgICAgICAgICAgdHVybjogZGF0YS50dXJuXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICBjb25zdCB3aW5PYmogPSBjaGVja1dpblYyKGRhdGEudHVybiwgZGF0YS5tb3Zlcyk7XG4gICAgICAgICAgICAgICAgaWYgKHdpbk9iaiAhPT0gZmFsc2UpIHtcblxuICAgICAgICAgICAgICAgICAgICBpby50byhkYXRhLnJvb20pLmVtaXQoJ2dhbWUtcmVzdWx0Jywge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2lubmVyOiB3aW5PYmouc3ltYm9sLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0OiAnZG9uZScsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb21iaW5hdGlvbjogd2luT2JqLmNvbWJpbmF0aW9uXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpc0RyYXcoZGF0YS5tb3ZlcykpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2RyYXcnLCBpc0RyYXcoZGF0YS5tb3ZlcykpO1xuICAgICAgICAgICAgICAgICAgICBpby50byhkYXRhLnJvb20pLmVtaXQoJ2dhbWUtcmVzdWx0Jywge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2lubmVyOiAnbm9uZScsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQ6ICdkcmF3J1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBzb2NrZXQub24oJ3RpbWVzLXVwJywgKGRhdGEpID0+IHtcbiAgICAgICAgICAgICAgICBpby50byhkYXRhLnJvb20pLmVtaXQoJ2dhbWUtcmVzdWx0Jywge1xuICAgICAgICAgICAgICAgICAgICB3aW5uZXI6ICdub25lJyxcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0OiAndGltZXN1cCcsXG4gICAgICAgICAgICAgICAgICAgIHdpbm5lcjogZGF0YS5zeW1ib2wgPT09ICd4JyA/ICdjaXJjbGUnIDogJ3gnXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgc29ja2V0Lm9uKCdqb2luLXJvb20nLCAoZGF0YSkgPT4ge1xuXG4gICAgICAgICAgICAgICAgZ2V0QXZhaWxhYmxlUm9vbShpbykudGhlbihyID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHIpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZmluZCBhdmFpbGFibGUgcm9vbSBhbmQgam9pblxuICAgICAgICAgICAgICAgICAgICAgICAgZ2V0Um9vbURldGFpbHMocikudGhlbihoID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb2NrZXQuZW1pdCgnam9pbmVkLXJvb20nLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByb29tOiByLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNIb3N0OiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzUmVhZHk6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiAodHlwZW9mIGguaG9zdE5hbWUgPT09ICd1bmRlZmluZWQnIHx8IGguaG9zdE5hbWUgPT09IG51bGwgfHwgaC5ob3N0TmFtZSA9PT0gJycpID8gJ3Vua25vd24nIDogaC5ob3N0TmFtZVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzb2NrZXQudG8ocikuZW1pdCgnZ2FtZS1yZWFkeScsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlzUmVhZHk6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBkYXRhLm5hbWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc29ja2V0LmpvaW4ocik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSByb29tXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgYXV0b3Jvb20gPSB1dWlkdjQoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvY2tldC5qb2luKGF1dG9yb29tKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFJPT01TLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhvc3RJZDogZGF0YS5pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBob3N0TmFtZTogZGF0YS5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvb206IGF1dG9yb29tXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNvY2tldC5lbWl0KCdqb2luZWQtcm9vbScsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb29tOiBhdXRvcm9vbSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc0hvc3Q6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNSZWFkeTogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICBmdW5jdGlvbiBnZXRBY3RpdmVSb29tcyhpbykge1xuICAgICAgICAgICAgLy8gQ29udmVydCBtYXAgaW50byAyRCBsaXN0OlxuICAgICAgICAgICAgLy8gPT0+IFtbJzR6aUJLRzlYRlMwNk5kdFZBQUFIJywgU2V0KDEpXSwgWydyb29tMScsIFNldCgyKV0sIC4uLl1cbiAgICAgICAgICAgIGNvbnN0IGFyciA9IEFycmF5LmZyb20oaW8uc29ja2V0cy5hZGFwdGVyLnJvb21zKTtcbiAgICAgICAgICAgIC8vIEZpbHRlciByb29tcyB3aG9zZSBuYW1lIGV4aXN0IGluIHNldDpcbiAgICAgICAgICAgIC8vID09PiBbWydyb29tMScsIFNldCgyKV0sIFsncm9vbTInLCBTZXQoMildXVxuICAgICAgICAgICAgY29uc3QgZmlsdGVyZWQgPSBhcnIuZmlsdGVyKHJvb20gPT4gIXJvb21bMV0uaGFzKHJvb21bMF0pKVxuICAgICAgICAgICAgLy8gUmV0dXJuIG9ubHkgdGhlIHJvb20gbmFtZTogXG4gICAgICAgICAgICAvLyA9PT4gWydyb29tMScsICdyb29tMiddXG4gICAgICAgICAgICBjb25zdCByZXMgPSBmaWx0ZXJlZC5tYXAoaSA9PiBpWzBdKTtcbiAgICAgICAgICAgIHJldHVybiByZXM7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBhZG1pbkdldFJvb21zID0gKGlvKSA9PiB7XG4gICAgICAgICAgICBpby5lbWl0KCdhZG1pbi1yb29tcycsIHtcbiAgICAgICAgICAgICAgICByb29tczogUk9PTVMsXG4gICAgICAgICAgICAgICAgYWN0aXZlUm9vbXM6IGdldEFjdGl2ZVJvb21zKGlvKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBpc0RyYXcgPSAoX21vdmVzKSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gWy4uLl9tb3Zlc10uZXZlcnkoaW5kZXggPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBpbmRleCA9PT0gXCJjaXJjbGVcIiB8fCBpbmRleCA9PT0gXCJ4XCJcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBjaGVja1dpbiA9IChzeW1ib2wsIF9tb3ZlcykgPT4ge1xuICAgICAgICAgICAgcmV0dXJuIFdJTl9DT04uc29tZShjb21iaW5hdGlvbiA9PiB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNvbWJpbmF0aW9uLmV2ZXJ5KGluZGV4ID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF9tb3Zlc1tpbmRleF0gPT09IHN5bWJvbFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgY2hlY2tXaW5WMiA9IChzeW1ib2wsIF9tb3ZlcykgPT4ge1xuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBXSU5fQ09OLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgYyA9IFdJTl9DT05baV0uZXZlcnkoaW5kZXggPT4gX21vdmVzW2luZGV4XSA9PT0gc3ltYm9sKTtcbiAgICAgICAgICAgICAgICBpZiAoYykgcmV0dXJuIHsgY29tYmluYXRpb246IFdJTl9DT05baV0sIHN5bWJvbDogc3ltYm9sIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBnZXRBdmFpbGFibGVSb29tID0gYXN5bmMgKGlvKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByb29tcyA9IGdldEFjdGl2ZVJvb21zKGlvKTtcbiAgICAgICAgICAgIGZvciAobGV0IHJvb20gb2Ygcm9vbXMpIHtcbiAgICAgICAgICAgICAgICBsZXQgYyA9IGF3YWl0IGlvLmluKHJvb20pLmZldGNoU29ja2V0cygpO1xuICAgICAgICAgICAgICAgIGxldCBmaWx0ZXJlZCA9IGMubWFwKGZ1bmN0aW9uIChpdGVtKSB7IHJldHVybiBpdGVtLmlkOyB9KTtcbiAgICAgICAgICAgICAgICBpZiAoZmlsdGVyZWQubGVuZ3RoID09PSAxKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByb29tO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdubyByb29tIGF2YWlsYWJsZScpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZ2V0Um9vbURldGFpbHMgPSBhc3luYyAocm9vbSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgaCA9IGF3YWl0IFJPT01TLmZpbmQoaXRlbSA9PiBpdGVtLnJvb20gPT09IHJvb20pO1xuICAgICAgICAgICAgaWYgKGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yOiBObyByb29tIGZvdW5kLCBGdW5jdGlvbjogZ2V0Um9vbURldGFpbHMnKVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZ2V0Um9vbUNsaWVudHMgPSBhc3luYyAoaW8sIHJvb20pID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGMgPSBhd2FpdCBpby5pbihyb29tKS5mZXRjaFNvY2tldHMoKTtcbiAgICAgICAgICAgIGNvbnN0IGZpbHRlcmVkID0gYy5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsgcmV0dXJuIGl0ZW0uaWQ7IH0pO1xuICAgICAgICAgICAgcmV0dXJuIGZpbHRlcmVkO1xuICAgICAgICB9XG5cbiAgICAgICAgcmVzLnNvY2tldC5zZXJ2ZXIuaW8gPSBpb1xuICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKCdzb2NrZXQuaW8gYWxyZWFkeSBydW5uaW5nJyk7XG4gICAgfVxuICAgIHJlcy5lbmQoKTtcbn1cblxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcbiAgICBhcGk6IHtcbiAgICAgICAgYm9keVBhcnNlcjogZmFsc2VcbiAgICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IFNvY2tldGlvOyJdLCJuYW1lcyI6WyJTZXJ2ZXIiLCJ2NCIsInV1aWR2NCIsIlNvY2tldGlvIiwicmVxIiwicmVzIiwiV0lOX0NPTiIsIlJPT01TIiwiUExBWUVSUyIsInN0YXR1cyIsImpzb24iLCJ1c2VyIiwic29ja2V0Iiwic2VydmVyIiwiaW8iLCJjb25zb2xlIiwibG9nIiwiZ2V0VW5pcXVlTGlzdEJ5IiwiYXJyIiwia2V5IiwiTWFwIiwibWFwIiwiaXRlbSIsInZhbHVlcyIsImlzUGxheWVyRXhpc3QiLCJvYmoiLCJpIiwibGVuZ3RoIiwiaWQiLCJuYW1lIiwib24iLCJlbWl0c2VydmVyRGF0YSIsImVtaXQiLCJvbmxpbmVQbGF5ZXJzIiwiZmlsdGVyIiwicCIsIm9uQW55IiwiZXZlbnQiLCJhcmdzIiwidHlwZSIsInNvY2tldElkIiwid2luIiwibG9zZSIsImRyYXciLCJwdXNoIiwib2JqSW5kZXgiLCJmaW5kSW5kZXgiLCJkYXRhIiwidG8iLCJyb29tIiwidGltZXIiLCJBcnJheSIsImZyb20iLCJyb29tcyIsImxlYXZlIiwiaG9zdElkIiwiY2FsbGJhY2siLCJhY2NlcHRSZW1hdGNoIiwiaXNSZWFkeSIsIm1vdmVzIiwidHVybiIsIndpbk9iaiIsImNoZWNrV2luVjIiLCJ3aW5uZXIiLCJzeW1ib2wiLCJyZXN1bHQiLCJjb21iaW5hdGlvbiIsImlzRHJhdyIsImdldEF2YWlsYWJsZVJvb20iLCJ0aGVuIiwiciIsImdldFJvb21EZXRhaWxzIiwiaCIsImlzSG9zdCIsImhvc3ROYW1lIiwiam9pbiIsImF1dG9yb29tIiwiZ2V0QWN0aXZlUm9vbXMiLCJzb2NrZXRzIiwiYWRhcHRlciIsImZpbHRlcmVkIiwiaGFzIiwiYWRtaW5HZXRSb29tcyIsImFjdGl2ZVJvb21zIiwiX21vdmVzIiwiZXZlcnkiLCJpbmRleCIsImNoZWNrV2luIiwic29tZSIsImMiLCJpbiIsImZldGNoU29ja2V0cyIsImZpbmQiLCJnZXRSb29tQ2xpZW50cyIsImVuZCIsImNvbmZpZyIsImFwaSIsImJvZHlQYXJzZXIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/socketio.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = (__webpack_exec__("(api)/./pages/api/socketio.js"));
module.exports = __webpack_exports__;

})();